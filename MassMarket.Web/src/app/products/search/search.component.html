<mat-sidenav-container>
  <mat-sidenav #sideNav mode="side" opened class="p-a">
    <button id="sidenav-close" mat-icon-button (click)="sideNav.toggle()">
      <mat-icon>menu</mat-icon>
    </button>
    <div *ngIf="searchOptions">
      <form [formGroup]="searchForm">
        <h2>Search for products</h2>
        <mat-form-field class="full-width">
          <input formControlName="queryText" matInput placeholder="Search query">
        </mat-form-field>
        <mat-form-field class="full-width">
          <mat-select formControlName="categoryId" placeholder="Category" (selectionChange)="search()">
            <ng-container *ngFor="let category of searchOptions.categories">
              <mat-option [class.option-group]="category.id !== 0" [value]="category.id">
                {{category.name}}
              </mat-option>
              <mat-option class="sub-option" *ngFor="let childCategory of category.childCategories" [value]="childCategory.id">
                {{childCategory.name}}
              </mat-option>
            </ng-container>
          </mat-select>
        </mat-form-field>
        <div class="m-b">
          <mat-label>Minimum price</mat-label>
          <mat-slider #minPriceSlider class="full-width p-a-0" formControlName="minPrice" [max]="searchResult?.maxPrice" [min]="searchResult?.minPrice"></mat-slider>
          <mat-hint *ngIf="minPriceSlider.value">€ {{minPriceSlider.value}}</mat-hint>
        </div>
        <div class="m-b">
          <mat-label>Maximum price</mat-label>
          <mat-slider #maxPriceSlider class="full-width p-a-0" formControlName="maxPrice" [max]="searchResult?.maxPrice" [min]="minPriceSlider.value"></mat-slider>
          <mat-hint *ngIf="maxPriceSlider.value">€ {{maxPriceSlider.value}}</mat-hint>
        </div>
        <button mat-raised-button color="primary" class="full-width" (click)="search()">Search</button>
      </form>
    </div>
  </mat-sidenav>
  <mat-toolbar fxLayout="column">
    <mat-button-toggle-group fxFlexAlign="flex-end">
      <mat-button-toggle [checked]="currentView === ProductView.Grid" (click)="changeView(ProductView.Grid)">
        <mat-icon>view_comfy</mat-icon>
      </mat-button-toggle>
      <mat-button-toggle [checked]="currentView === ProductView.List" (click)="changeView(ProductView.List)">
        <mat-icon>view_list</mat-icon>
      </mat-button-toggle>
    </mat-button-toggle-group>
  </mat-toolbar>
  <mat-progress-bar mode="indeterminate" *ngIf="searching"></mat-progress-bar>
  <div *ngIf="searchResult?.products" fxflex fxLayout="row wrap" id="search-results" class="p-a" [class.searching]="searching">
    <ng-container *ngIf="currentView === ProductView.Grid">
      <mm-product-card *ngFor="let product of searchResult.products" [product]="product" fxflex fxFlex="20%" fxFlex.xs="100" fxFlex.sm="50"
        fxFlex.md="33" fxFlex.lg="20"></mm-product-card>
    </ng-container>
    <ng-container *ngIf="currentView === ProductView.List">
      <mat-list fxLayout="columng wrap">
        <ng-container *ngFor="let product of searchResult.products; let i = index">
          <mm-product-list-item [product]="product" fxflex fxFlex="100%"></mm-product-list-item>
          <mat-divider fxFlex="100%" *ngIf="i + 1 !== searchResult.products.length"></mat-divider>
        </ng-container>
      </mat-list>
    </ng-container>
  </div>
</mat-sidenav-container>